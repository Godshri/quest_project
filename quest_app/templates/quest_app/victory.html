{% extends 'quest_app/base.html' %}
{% load static %}

{% block content %}
<div class="victory">
    <h2><i class="fa-solid fa-trophy fa-pixel fa-orange"></i> –ü–û–ó–î–†–ê–í–õ–Ø–ï–ú! <i class="fa-solid fa-trophy fa-pixel fa-orange"></i></h2>
    <p>–¢—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–µ–ª –≤—Å–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è –∏ —Å—Ç–∞–ª –Ω–∞—Å—Ç–æ—è—â–∏–º –ú–∞—Å—Ç–µ—Ä–æ–º –ö–æ–¥–∞!</p>
    <div class="trophy">
        <i class="fa-solid fa-medal fa-pixel" style="font-size: 80px; color: #ff6b35;"></i>
    </div>
    <p>–° –î–Ω–µ–º –ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞!</p>
    
    <div class="victory-actions">
        <a href="{% url 'game' %}" class="pixel-button">
            <i class="fa-solid fa-rotate-right fa-pixel"></i> –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞
        </a>
        <a href="{% url 'index' %}" class="pixel-button">
            <i class="fa-solid fa-house fa-pixel"></i> –ù–∞ –≥–ª–∞–≤–Ω—É—é
        </a>
    </div>
</div>

<audio id="victory-music" loop>
    <source src="{% static 'quest_app/audio/victory_music.mp3' %}" type="audio/mpeg">
</audio>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –ø–æ–±–µ–¥–Ω—É—é –º—É–∑—ã–∫—É
    const victoryMusic = document.getElementById('victory-music');
    if (victoryMusic) {
        victoryMusic.volume = 0.4;
        victoryMusic.play().catch(e => {
            console.log('–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ, –∂–¥–µ–º –∫–ª–∏–∫–∞');
        });
    }
    
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–≤—É–∫–æ–º
    let isMuted = false;
    const muteButton = document.getElementById('mute-button');
    
    if (muteButton) {
        muteButton.addEventListener('click', function() {
            isMuted = !isMuted;
            if (victoryMusic) {
                victoryMusic.muted = isMuted;
            }
            muteButton.textContent = isMuted ? 'üîá' : 'üîä';
        });
    }
    
    // –ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ
    document.addEventListener('click', function() {
        if (victoryMusic && victoryMusic.paused) {
            victoryMusic.play().catch(e => console.log('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:', e));
        }
    }, { once: true });
});
</script>
{% endblock %}