{% extends 'quest_app/base.html' %}
{% load static %}

{% block content %}
<div class="victory">
    <h2><i class="fa-solid fa-trophy fa-pixel fa-orange"></i> –ü–û–ë–ï–î–ê! <i class="fa-solid fa-trophy fa-pixel fa-orange"></i></h2>
    
    <div class="victory-content">
        <div class="trophy">
            <i class="fa-solid fa-medal fa-pixel" style="font-size: 80px; color: #ff6b35;"></i>
        </div>
        
        <div class="victory-message">
            <p>–¢—ã –ø—Ä–æ—à–µ–ª(–ª–∞) –≤—Å–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è Digital-–∫–≤–µ—Å—Ç–∞ –æ—Ç –ö–≤–∞–Ω—Ç–æ—Ä–∏—É–º–∞ –∏ –¥–æ–∫–∞–∑–∞–ª(–∞), —á—Ç–æ —Ç–≤–æ–π –∫–æ–¥ ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –Ω—É–ª–∏ –∏ –µ–¥–∏–Ω–∏—Ü—ã!</p>
            <p>–¢—ã –æ—Å–≤–æ–∏–ª(–∞) —Ç–∞–π–Ω—ã –∂–µ–ª–µ–∑–∞ –≤ –°–µ—Ä–≤–µ—Ä–Ω–æ–π, –æ–∫—É–Ω—É–ª—Å—è(–∞—Å—å) –≤ –∏—Å—Ç–æ—Ä–∏—é –≤ –ë–∏–±–ª–∏–æ—Ç–µ–∫–µ, –ø—Ä–æ—à–µ–ª(–ª–∞) –∏—Å–ø—ã—Ç–∞–Ω–∏—è –ê—Ä–∫–∞–¥—ã –∏ –∑–∞–≥–ª—è–Ω—É–ª(–∞) –≤ –±—É–¥—É—â–µ–µ –Ω–∞ –ö—Ä—ã—à–µ. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –±—É–¥—É—â–µ–≥–æ –∂–¥—É—Ç –∏–º–µ–Ω–Ω–æ —Ç–µ–±—è!</p>
        </div>

        <div class="unique-id-card">
            <h3>–¢–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è:</h3>
            <div class="id-display" id="unique-id">
                <span id="id-text">{{ unique_id }}</span>
                <button class="pixel-button copy-btn" onclick="copyToClipboard()">
                    <i class="fa-solid fa-copy fa-pixel"></i>
                </button>
            </div>
            <p class="id-instructions">–°–æ—Ö—Ä–∞–Ω–∏ —ç—Ç–æ—Ç –∫–æ–¥ –∏ –ø—Ä–µ–¥—ä—è–≤–∏ –µ–≥–æ –Ω–∞ –ª—é–±–æ–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–∏ –ö–≤–∞–Ω—Ç–æ—Ä–∏—É–º–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø–∞–º—è—Ç–Ω–æ–≥–æ –ø—Ä–∏–∑–∞!</p>
        </div>

        <div class="social-share">
            <h3>–î–µ–ª–∏—Å—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ–º —Å —Ö–µ—à—Ç–µ–≥–∞–º–∏:</h3>
            <div class="hashtags">
                <span class="hashtag">#–ö–≤–∞–Ω—Ç–æ—Ä–∏—É–º–ü–æ–±–µ–¥–∏—Ç–µ–ª—å</span>
                <span class="hashtag">#Digital–ö–≤–µ—Å—Ç</span>
                <span class="hashtag">#–ö–æ–¥–ë—É–¥—É—â–µ–≥–æ</span>
                <span class="hashtag">#–Ø–≤IT</span>
            </div>
        </div>

        <div class="call-to-action">
            <p>–ì–æ—Ç–æ–≤ –∫–æ–¥–∏—Ç—å –±—É–¥—É—â–µ–µ? –ó–∞–ø–∏—Å—ã–≤–∞–π—Å—è –Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ö–≤–∞–Ω—Ç–æ—Ä–∏—É–º–∞ –∏ —Å—Ç–∞–Ω—å —Ç–≤–æ—Ä—Ü–æ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π!</p>
        </div>
    </div>
    
    <div class="victory-actions">
        <a href="{% url 'index' %}" class="pixel-button">
            <i class="fa-solid fa-house fa-pixel"></i> –ù–∞ –≥–ª–∞–≤–Ω—É—é
        </a>

    </div>
</div>

<audio id="victory-music" loop>
    <source src="{% static 'quest_app/audio/victory_music.mp3' %}" type="audio/mpeg">
</audio>

<script>

function copyToClipboard() {
    const idText = document.getElementById('id-text');
    navigator.clipboard.writeText(idText.textContent).then(() => {
        const btn = document.querySelector('.copy-btn');
        const originalHtml = btn.innerHTML;
        btn.innerHTML = '<i class="fa-solid fa-check fa-pixel"></i>';
        setTimeout(() => {
            btn.innerHTML = originalHtml;
        }, 2000);
    });
}

document.addEventListener('DOMContentLoaded', function() {
    
    const victoryMusic = document.getElementById('victory-music');
    if (victoryMusic && victoryMusic.paused) {
        victoryMusic.volume = 0.4;
        victoryMusic.play().catch(e => {
            console.log('–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ, –∂–¥–µ–º –∫–ª–∏–∫–∞');
        });
    }
    
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–≤—É–∫–æ–º
    let isMuted = false;
    const muteButton = document.getElementById('mute-button');
    
    if (muteButton) {
        muteButton.addEventListener('click', function() {
            isMuted = !isMuted;
            if (victoryMusic) {
                victoryMusic.muted = isMuted;
            }
            muteButton.textContent = isMuted ? 'üîá' : 'üîä';
        });
    }
    
    // –ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ
    document.addEventListener('click', function() {
        if (victoryMusic && victoryMusic.paused) {
            victoryMusic.play().catch(e => console.log('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:', e));
        }
    }, { once: true });
});
</script>
{% endblock %}