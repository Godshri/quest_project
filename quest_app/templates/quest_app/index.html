{% extends 'quest_app/base.html' %}
{% load static %}

{% block content %}
<div class="start-screen">
    <div class="pixel-welcome">
        <h2>
            <i class="fa-solid fa-gamepad fa-pixel fa-headered fa-blue"></i>
            –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞
            <i class="fa-solid fa-dragon fa-pixel fa-headered fa-orange"></i>
        </h2>
        <div class="pixel-divider"></div>
        
        <div class="game-description">
            <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Digital-–∫–≤–µ—Å—Ç –æ—Ç –ö–≤–∞–Ω—Ç–æ—Ä–∏—É–º–∞! <span class="pixel-emoji">üöÄ</span></p>
            <p>–¢–µ–±—è –∂–¥–µ—Ç —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –ø–æ –º–∏—Ä—É —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π, –≥–¥–µ —Ç—ã —Å–º–æ–∂–µ—à—å –ø—Ä–æ—è–≤–∏—Ç—å —Å–≤–æ–∏ –Ω–∞–≤—ã–∫–∏ –∏ –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ.</p>
        </div>

        <!-- –ë–ª–æ–∫ —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∏–≥—Ä—ã -->
        <div class="game-rules">
            <h3><i class="fa-solid fa-book fa-pixel fa-blue"></i> –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã:</h3>
            <div class="rules-list">
                <div class="rule-item">
                    <i class="fa-solid fa-heart fa-pixel fa-red"></i>
                    <span>–£ —Ç–µ–±—è –µ—Å—Ç—å <strong>5 —Å–µ—Ä–¥–µ—Ü</strong> - –Ω–µ —Ç–µ—Ä—è–π –∏—Ö –≤—Å–µ!</span>
                </div>
                <div class="rule-item">
                    <i class="fa-solid fa-puzzle-piece fa-pixel fa-orange"></i>
                    <span>–í—Å–µ–≥–æ <strong>12 –∑–∞–≥–∞–¥–æ–∫</strong> –≤ 4 —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç–∞—Ö</span>
                </div>
                <div class="rule-item">
                    <i class="fa-solid fa-lock fa-pixel fa-blue"></i>
                    <span>–ö–æ–º–Ω–∞—Ç–∞ "–ö—Ä—ã—à–∞" –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –ø–æ—Å–ª–µ —Ä–µ—à–µ–Ω–∏—è 9 –∑–∞–≥–∞–¥–æ–∫</span>
                </div>
                <div class="rule-item">
                    <i class="fa-solid fa-warning fa-pixel fa-yellow"></i>
                    <span>–ù–µ –ø–µ—Ä–µ–∫–ª—é—á–∞–π –≤–∫–ª–∞–¥–∫—É - –∏–≥—Ä–∞ –º–æ–∂–µ—Ç —Å–±—Ä–æ—Å–∏—Ç—å—Å—è!</span>
                </div>
            </div>
        </div>

        <!-- –ë–ª–æ–∫ —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∫–≤–µ—Å—Ç–∞ -->
        <div class="quest-structure">
            <h3><i class="fa-solid fa-map fa-pixel fa-green"></i> –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–≤–µ—Å—Ç–∞:</h3>
            <div class="rooms-grid">
                <div class="room-card">
                    <i class="fa-solid fa-server fa-pixel fa-blue"></i>
                    <h4>–°–µ—Ä–≤–µ—Ä–Ω–∞—è</h4>
                    <p>3 –∑–∞–≥–∞–¥–∫–∏ –ø—Ä–æ –∂–µ–ª–µ–∑–æ –∏ —Å–µ—Ç–∏</p>
                </div>
                <div class="room-card">
                    <i class="fa-solid fa-book fa-pixel fa-brown"></i>
                    <h4>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞</h4>
                    <p>3 –∑–∞–≥–∞–¥–∫–∏ –ø—Ä–æ –∏—Å—Ç–æ—Ä–∏—é IT</p>
                </div>
                <div class="room-card">
                    <i class="fa-solid fa-gamepad fa-pixel fa-purple"></i>
                    <h4>–ê—Ä–∫–∞–¥–∞</h4>
                    <p>3 –∑–∞–≥–∞–¥–∫–∏ –ø—Ä–æ –∏–≥—Ä—ã –∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã</p>
                </div>
                <div class="room-card">
                    <i class="fa-solid fa-building fa-pixel fa-gray"></i>
                    <h4>–ö—Ä—ã—à–∞</h4>
                    <p>3 —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –∑–∞–≥–∞–¥–∫–∏ –ø—Ä–æ –±—É–¥—É—â–µ–µ</p>
                </div>
            </div>
        </div>

        <!-- –ë–ª–æ–∫ —Å –Ω–∞–≥—Ä–∞–¥–∞–º–∏ -->
        <div class="rewards-info">
            <h3><i class="fa-solid fa-trophy fa-pixel fa-gold"></i> –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –ø–æ–±–µ–¥—É:</h3>
            <div class="reward-content">
                <p>–ü–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –≤—Å–µ—Ö 12 –∑–∞–≥–∞–¥–æ–∫ —Ç—ã –ø–æ–ª—É—á–∏—à—å:</p>
                <ul>
                    <li><i class="fa-solid fa-certificate fa-pixel fa-blue"></i> –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è</li>
                    <li><i class="fa-solid fa-gift fa-pixel fa-red"></i> –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–∑ –≤ –ö–≤–∞–Ω—Ç–æ—Ä–∏—É–º–µ</li>
                    <li><i class="fa-solid fa-star fa-pixel fa-yellow"></i> –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç Digital-–∫–≤–µ—Å—Ç–∞</li>
                </ul>
            </div>
        </div>

        <div class="character-selection">
            <h3>–í—ã–±–µ—Ä–∏ —Å–≤–æ–µ–≥–æ –≥–µ—Ä–æ—è:</h3>
            <div class="characters">
                <div class="character selected" data-char="wizard">
                    <i class="fa-solid fa-hat-wizard fa-pixel fa-character fa-blue"></i>
                    <span>–í–æ–ª—à–µ–±–Ω–∏–∫ –ö–æ–¥–∞</span>
                </div>
                <div class="character" data-char="hacker">
                    <i class="fa-solid fa-laptop-code fa-pixel fa-character fa-blue"></i>
                    <span>–•–∞–∫–µ—Ä</span>
                </div>
                <div class="character" data-char="robot">
                    <i class="fa-solid fa-robot fa-pixel fa-character fa-blue"></i>
                    <span>–†–æ–±–æ—Ç-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç</span>
                </div>
            </div>
        </div>

        <a href="{% url 'game' %}" class="pixel-button start-button">
            <i class="fa-solid fa-rocket fa-pixel fa-button fa-orange"></i>
            <span class="button-text">–ù–ê–ß–ê–¢–¨ –ü–†–ò–ö–õ–Æ–ß–ï–ù–ò–ï</span>
        </a>
        
        <audio id="main-menu-music" loop>
            <source src="{% static 'quest_app/audio/main_menu_music.mp3' %}" type="audio/mpeg">
        </audio>
        
        <audio id="character-select-sound">
            <source src="{% static 'quest_app/audio/character_select.mp3' %}" type="audio/mpeg">
        </audio>
    </div>
</div>

<button id="mute-button" class="pixel-button sound-control-button">üîä</button>


<script>
document.addEventListener('DOMContentLoaded', function() {
    const characters = document.querySelectorAll('.character');
    const selectSound = document.getElementById('character-select-sound');
    let selectedChar = 'wizard';
    
    characters.forEach(char => {
        char.addEventListener('click', function() {
            characters.forEach(c => c.classList.remove('selected'));
            this.classList.add('selected');
            selectedChar = this.dataset.char;
            
            if (selectSound) {
                selectSound.currentTime = 0;
                selectSound.play().catch(() => {});
            }
            
            localStorage.setItem('selectedCharacter', selectedChar);
        });
    });
    
    const savedChar = localStorage.getItem('selectedCharacter');
    if (savedChar) {
        characters.forEach(char => {
            char.classList.remove('selected');
            if (char.dataset.char === savedChar) {
                char.classList.add('selected');
                if (selectSound && savedChar !== 'wizard') {
                    setTimeout(() => {
                        selectSound.currentTime = 0;
                        selectSound.play().catch(() => {});
                    }, 300);
                }
            }
        });
    }
});

document.addEventListener('DOMContentLoaded', function() {
    const mainMenuMusic = document.getElementById('main-menu-music');
    const muteButton = document.getElementById('mute-button');
    let isMuted = false;
    
    if (mainMenuMusic) {
        mainMenuMusic.volume = 0.3;
        mainMenuMusic.play().catch(e => {
            console.log('–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ');
        });
    }
    
    if (muteButton) {
        muteButton.addEventListener('click', function() {
            isMuted = !isMuted;
            if (mainMenuMusic) {
                mainMenuMusic.muted = isMuted;
            }
            muteButton.textContent = isMuted ? 'üîá' : 'üîä';
        });
    }
    
    document.addEventListener('click', function() {
        if (mainMenuMusic && mainMenuMusic.paused) {
            mainMenuMusic.play().catch(e => console.log('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:', e));
        }
    }, { once: true });
});
</script>
{% endblock %}