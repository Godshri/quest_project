{% extends 'quest_app/base.html' %}
{% load static %}

{% block content %}
<div class="start-screen">
    <div class="pixel-welcome">
        <h2>üéÆ –ü–∏–∫—Å–µ–ª—å–Ω–æ–µ –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞ üêâ</h2>
        <div class="pixel-divider"></div>
        
        <div class="game-description">
            <p>–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º, –±—É–¥—É—â–∏–π –º–∞—Å—Ç–µ—Ä –∫–æ–¥–∞! üßô‚Äç‚ôÇÔ∏è</p>

        <div class="character-selection">
            <h3>–í—ã–±–µ—Ä–∏ —Å–≤–æ–µ–≥–æ –≥–µ—Ä–æ—è:</h3>
            <div class="characters">
                <div class="character selected" data-char="wizard">
                    <div class="char-icon">üßô‚Äç‚ôÇÔ∏è</div>
                    <span>–í–æ–ª—à–µ–±–Ω–∏–∫ –ö–æ–¥–∞</span>
                </div>
                <div class="character" data-char="hacker">
                    <div class="char-icon">üë®‚Äçüíª</div>
                    <span>–•–∞–∫–µ—Ä</span>
                </div>
                <div class="character" data-char="robot">
                    <div class="char-icon">ü§ñ</div>
                    <span>–†–æ–±–æ—Ç-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç</span>
                </div>
            </div>
        </div>

        <a href="{% url 'game' %}" class="pixel-button start-button">üöÄ –ù–∞—á–∞—Ç—å –ö–≤–µ—Å—Ç!</a>
        <audio id="main-menu-music" loop>
            <source src="{% static 'quest_app/audio/main_menu_music.mp3' %}" type="audio/mpeg">
        </audio>
    
    <button id="mute-button" class="pixel-button" style="position: fixed; top: 20px; right: 20px;">üîä</button>

    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const characters = document.querySelectorAll('.character');
    let selectedChar = 'wizard';
    
    characters.forEach(char => {
        char.addEventListener('click', function() {
            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —É –≤—Å–µ—Ö
            characters.forEach(c => c.classList.remove('selected'));
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É
            this.classList.add('selected');
            selectedChar = this.dataset.char;
            
            // –ú–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–±–æ—Ä –≤ localStorage –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            localStorage.setItem('selectedCharacter', selectedChar);
        });
    });
    
    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–±–æ—Ä –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    const savedChar = localStorage.getItem('selectedCharacter');
    if (savedChar) {
        characters.forEach(char => {
            char.classList.remove('selected');
            if (char.dataset.char === savedChar) {
                char.classList.add('selected');
            }
        });
    }
});

document.addEventListener('DOMContentLoaded', function() {
    const mainMenuMusic = document.getElementById('main-menu-music');
    const muteButton = document.getElementById('mute-button');
    let isMuted = false;
    
    if (mainMenuMusic) {
        mainMenuMusic.volume = 0.3;
        mainMenuMusic.play().catch(e => {
            console.log('–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ');
        });
    }
    
    if (muteButton) {
        muteButton.addEventListener('click', function() {
            isMuted = !isMuted;
            if (mainMenuMusic) {
                mainMenuMusic.muted = isMuted;
            }
            muteButton.textContent = isMuted ? 'üîá' : 'üîä';
        });
    }
    
    document.addEventListener('click', function() {
        if (mainMenuMusic && mainMenuMusic.paused) {
            mainMenuMusic.play().catch(e => console.log('–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:', e));
        }
    }, { once: true });
});
</script>
{% endblock %}